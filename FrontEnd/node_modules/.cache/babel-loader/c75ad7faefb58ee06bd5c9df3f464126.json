{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/mcintosh/Desktop/Final/front-end-final-project-callback-cats/thumb-o-meter/src/components/skPoll/index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport style from \"./index.module.css\";\nimport { Input, Select, Stack, HStack, Button, Center } from \"@chakra-ui/react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport useSocketContext from \"../../context/socketContext\";\nimport SkPollResults from \"../skPollResults\";\nimport { ArrowBackIcon, EditIcon, DeleteIcon } from \"@chakra-ui/icons\";\nimport { Link } from \"react-router-dom\";\nimport StartSession from \"../massAlert/startSession\";\nimport { VscDebugStart } from \"react-icons/vsc\";\n\nfunction SkPoll() {\n  _s();\n\n  const [question, setQuestion] = useState(\"Set Custom Question\");\n  const [custom, setCustom] = useState(false);\n  const [myColor] = useState(\"#2C276B\");\n  const [value, setValue] = useState(0);\n  const [optionData, setOptionData] = useState([]);\n  const [resultsObj, setResultsObj] = useState({});\n  const [pollStarted, setPollStarted] = useState(false);\n  const context = useSocketContext();\n  const socket = context[0];\n  useEffect(() => {\n    socket.on(\"resultsUpdate\", obj => {\n      console.log(\"Results update received\");\n      updateResultsObj(obj);\n    });\n    socket.on(\"pollStart\", ({\n      data\n    }) => {\n      console.log(\"data from server at poll start\", data);\n    });\n    return () => {\n      socket.off(\"resultsUpdate\");\n      socket.off(\"pollStart\");\n    };\n  }, []);\n\n  function updateResultsObj(obj) {\n    console.log(\"Results update received\", obj);\n    setResultsObj(obj.data);\n  }\n\n  const arr = [];\n\n  for (let i = 0; i < value; i++) {\n    // console.log(i);\n    arr.push( /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Input, {\n        type: \"text\",\n        placeholder: `set option ${i + 1}`,\n        width: \"300px\",\n        id: i + 1,\n        onChange: handleOptions,\n        maxLength: \"30\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        for: `choice${i + 1}`,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          id: `choice${i + 1}`,\n          type: \"radio\",\n          name: \"correctButton\",\n          value: `${i + 1}`,\n          className: style.radio\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this));\n  }\n\n  function handleOptions(e) {\n    setOptionData({ ...optionData,\n      [e.target.id]: e.target.value\n    });\n  }\n\n  function remove() {\n    arr.pop();\n    setValue(value - 1);\n    console.log(arr);\n  }\n\n  function handleSubmit(e) {\n    e.preventDefault();\n    const correct = e.target.elements.correctButton.value;\n    const obj = {\n      question,\n      options: Object.keys(optionData).map(key => [Number(key), optionData[key], 0]),\n      correctAnswer: correct,\n      uuid: uuidv4()\n    };\n    startPoll(obj);\n  }\n\n  function handleSession(e) {\n    if (e.target.value !== \"custom\") {\n      setCustom(false);\n      setQuestion(e.target.value);\n      console.log({\n        question\n      });\n    }\n\n    if (e.target.value === \"custom\") {\n      setCustom(true);\n    }\n  }\n\n  function startPoll(data) {\n    socket.emit(\"pollStart\", {\n      data\n    });\n    setPollStarted(true);\n    setResultsObj(data);\n    console.log(\"Poll started - Data sent to server\", {\n      data\n    });\n  }\n\n  function stopPoll() {\n    setPollStarted(false);\n    setQuestion(question => \"\");\n    setOptionData(optionData => {});\n    setResultsObj(resultsObj => {});\n    setCustom(custom => false);\n    socket.emit(\"sessionStop\");\n    console.log(\"Speaker has ended poll\");\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: style.container,\n    style: {\n      backgroundColor: `${myColor}`\n    },\n    children: [/*#__PURE__*/_jsxDEV(StartSession, {\n      className: style.button,\n      message: \"Live Poll session starting. Head to the Live Quiz page to join!\",\n      icon: /*#__PURE__*/_jsxDEV(VscDebugStart, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 15\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), !pollStarted && /*#__PURE__*/_jsxDEV(\"form\", {\n      className: style.select,\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(Select, {\n        placeholder: \"Select a question\",\n        onChange: handleSession,\n        children: /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"custom\",\n          children: \"Set a custom question\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Input, {\n        focusBorderColor: \"lime\",\n        className: style.borderColor,\n        style: custom ? {\n          display: \"block\",\n          textAlign: \"center\",\n          borderColor: \"grey\"\n        } : {\n          display: \"none\"\n        },\n        placeholder: \"set custom question...\",\n        type: \"text\",\n        onChange: e => setQuestion(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Stack, {\n        className: \"optionsInput\",\n        children: arr\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Center, {\n        children: /*#__PURE__*/_jsxDEV(HStack, {\n          children: [value < 4 ? /*#__PURE__*/_jsxDEV(Button, {\n            style: {\n              color: \"white\"\n            },\n            colorScheme: myColor,\n            onClick: () => setValue(value + 1),\n            children: /*#__PURE__*/_jsxDEV(EditIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 17\n          }, this) : \"\", /*#__PURE__*/_jsxDEV(Button, {\n            style: {\n              color: \"white\"\n            },\n            colorScheme: \"\",\n            onClick: remove,\n            children: /*#__PURE__*/_jsxDEV(DeleteIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            style: {\n              color: \"white\"\n            },\n            colorScheme: \"\",\n            type: \"submit\",\n            children: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }, this), pollStarted && /*#__PURE__*/_jsxDEV(SkPollResults, {\n      question: resultsObj,\n      stopPoll: stopPoll,\n      socket: socket\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 9\n    }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Link, {\n      to: \"/\",\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        _hover: {\n          background: \"white\",\n          color: `${myColor}`\n        },\n        variant: \"outline\",\n        children: [/*#__PURE__*/_jsxDEV(ArrowBackIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this), \" Back\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 5\n  }, this);\n}\n\n_s(SkPoll, \"AXPk+jVkOKLOms5xqEXFt5+E/vg=\", false, function () {\n  return [useSocketContext];\n});\n\n_c = SkPoll;\nexport default SkPoll;\n\nvar _c;\n\n$RefreshReg$(_c, \"SkPoll\");","map":{"version":3,"sources":["/Users/mcintosh/Desktop/Final/front-end-final-project-callback-cats/thumb-o-meter/src/components/skPoll/index.js"],"names":["React","useState","useEffect","style","Input","Select","Stack","HStack","Button","Center","v4","uuidv4","useSocketContext","SkPollResults","ArrowBackIcon","EditIcon","DeleteIcon","Link","StartSession","VscDebugStart","SkPoll","question","setQuestion","custom","setCustom","myColor","value","setValue","optionData","setOptionData","resultsObj","setResultsObj","pollStarted","setPollStarted","context","socket","on","obj","console","log","updateResultsObj","data","off","arr","i","push","handleOptions","radio","e","target","id","remove","pop","handleSubmit","preventDefault","correct","elements","correctButton","options","Object","keys","map","key","Number","correctAnswer","uuid","startPoll","handleSession","emit","stopPoll","container","backgroundColor","button","select","borderColor","display","textAlign","color","background"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport style from \"./index.module.css\";\nimport { Input, Select, Stack, HStack, Button, Center } from \"@chakra-ui/react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport useSocketContext from \"../../context/socketContext\";\nimport SkPollResults from \"../skPollResults\";\nimport { ArrowBackIcon, EditIcon, DeleteIcon } from \"@chakra-ui/icons\";\nimport { Link } from \"react-router-dom\";\nimport StartSession from \"../massAlert/startSession\";\nimport { VscDebugStart } from \"react-icons/vsc\";\nfunction SkPoll() {\n  const [question, setQuestion] = useState(\"Set Custom Question\");\n  const [custom, setCustom] = useState(false);\n  const [myColor] = useState(\"#2C276B\");\n  const [value, setValue] = useState(0);\n  const [optionData, setOptionData] = useState([]);\n  const [resultsObj, setResultsObj] = useState({});\n  const [pollStarted, setPollStarted] = useState(false);\n\n  const context = useSocketContext();\n  const socket = context[0];\n\n  useEffect(() => {\n    socket.on(\"resultsUpdate\", (obj) => {\n      console.log(\"Results update received\");\n      updateResultsObj(obj);\n    });\n\n    socket.on(\"pollStart\", ({ data }) => {\n      console.log(\"data from server at poll start\", data);\n    });\n\n    return () => {\n      socket.off(\"resultsUpdate\");\n      socket.off(\"pollStart\");\n    };\n  }, []);\n\n  function updateResultsObj(obj) {\n    console.log(\"Results update received\", obj);\n    setResultsObj(obj.data);\n  }\n\n  const arr = [];\n  for (let i = 0; i < value; i++) {\n    // console.log(i);\n    arr.push(\n      <div>\n        <Input\n          type=\"text\"\n          placeholder={`set option ${i + 1}`}\n          width=\"300px\"\n          id={i + 1}\n          onChange={handleOptions}\n          maxLength=\"30\"\n        ></Input>\n        <label for={`choice${i + 1}`}>\n          <input\n            id={`choice${i + 1}`}\n            type=\"radio\"\n            name=\"correctButton\"\n            value={`${i + 1}`}\n            className={style.radio}\n          />\n          <span></span>\n        </label>\n      </div>\n    );\n  }\n\n  function handleOptions(e) {\n    setOptionData({\n      ...optionData,\n      [e.target.id]: e.target.value,\n    });\n  }\n\n  function remove() {\n    arr.pop();\n    setValue(value - 1);\n    console.log(arr);\n  }\n\n  function handleSubmit(e) {\n    e.preventDefault();\n\n    const correct = e.target.elements.correctButton.value;\n    const obj = {\n      question,\n      options: Object.keys(optionData).map((key) => [\n        Number(key),\n        optionData[key],\n        0,\n      ]),\n      correctAnswer: correct,\n      uuid: uuidv4(),\n    };\n\n    startPoll(obj);\n  }\n\n  function handleSession(e) {\n    if (e.target.value !== \"custom\") {\n      setCustom(false);\n      setQuestion(e.target.value);\n      console.log({ question });\n    }\n    if (e.target.value === \"custom\") {\n      setCustom(true);\n    }\n  }\n\n  function startPoll(data) {\n    socket.emit(\"pollStart\", { data });\n    setPollStarted(true);\n    setResultsObj(data);\n    console.log(\"Poll started - Data sent to server\", { data });\n  }\n\n  function stopPoll() {\n    setPollStarted(false);\n    setQuestion((question) => \"\");\n    setOptionData((optionData) => {});\n    setResultsObj((resultsObj) => {});\n    setCustom((custom) => false);\n    socket.emit(\"sessionStop\");\n    console.log(\"Speaker has ended poll\");\n  }\n\n  return (\n    <div className={style.container} style={{ backgroundColor: `${myColor}` }}>\n      <StartSession\n        className={style.button}\n        message=\"Live Poll session starting. Head to the Live Quiz page to join!\"\n        icon={<VscDebugStart />}\n      />\n      {!pollStarted && (\n        <form className={style.select} onSubmit={handleSubmit}>\n          <Select placeholder=\"Select a question\" onChange={handleSession}>\n            <option value=\"custom\">Set a custom question</option>\n          </Select>\n          <Input\n            focusBorderColor=\"lime\"\n            className={style.borderColor}\n            style={\n              custom\n                ? {\n                    display: \"block\",\n                    textAlign: \"center\",\n                    borderColor: \"grey\",\n                  }\n                : { display: \"none\" }\n            }\n            placeholder=\"set custom question...\"\n            type=\"text\"\n            onChange={(e) => setQuestion(e.target.value)}\n          />\n          <Stack className=\"optionsInput\">{arr}</Stack>\n          <Center>\n            <HStack>\n              {value < 4 ? (\n                <Button\n                  style={{ color: \"white\" }}\n                  colorScheme={myColor}\n                  onClick={() => setValue(value + 1)}\n                >\n                  <EditIcon />\n                </Button>\n              ) : (\n                \"\"\n              )}\n              <Button\n                style={{ color: \"white\" }}\n                colorScheme=\"\"\n                onClick={remove}\n              >\n                <DeleteIcon />\n              </Button>\n              <Button style={{ color: \"white\" }} colorScheme=\"\" type=\"submit\">\n                Submit\n              </Button>\n            </HStack>\n          </Center>\n        </form>\n      )}\n      {pollStarted && (\n        <SkPollResults\n          question={resultsObj}\n          stopPoll={stopPoll}\n          socket={socket}\n        />\n      )}{\" \"}\n      <br />\n      <Link to=\"/\">\n        <Button\n          _hover={{\n            background: \"white\",\n            color: `${myColor}`,\n          }}\n          variant=\"outline\"\n        >\n          <ArrowBackIcon /> Back\n        </Button>\n      </Link>\n    </div>\n  );\n}\nexport default SkPoll;\n"]},"metadata":{},"sourceType":"module"}